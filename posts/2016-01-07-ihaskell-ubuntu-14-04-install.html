<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Simplex Sigillum Veri - Install IHaskell on Ubuntu 14.04 with Stack</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Simplex Sigillum Veri</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Install IHaskell on Ubuntu 14.04 with Stack</h1>
            <article>
    <section class="header">
        Posted on January  7, 2016
        
    </section>
    <section>
        <p>In this post, we’re going through the installation of IHaskell on GNU/Linux (Ubuntu 14.04 in my case, though it should be pretty similar on other ditributions) step-by-step. We’ll see how the use of <em>Stack</em> will simplify the whole process, and how to get all the dependencies right!</p>
<h2 id="install-stack">Install Stack</h2>
<p>From <em>Stack</em> official <a href="http://docs.haskellstack.org/en/stable/install_and_upgrade.html">documentation</a>, for Ubuntu 14.04:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="fu">sudo</span> apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 575159689BEFB442
<span class="bu">echo</span> <span class="st">'deb http://download.fpcomplete.com/ubuntu trusty main'</span><span class="kw">|</span><span class="fu">sudo</span> tee /etc/apt/sources.list.d/fpco.list
<span class="fu">sudo</span> apt-get update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt-get install stack -y</code></pre></div>
<p>You should now be able to run the <code>stack</code> executable in a shell:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">stack</span> --help</code></pre></div>
<p>Being up-to-date is important, so setup your <em>Stack</em> global configuration <code>~/.stack/global/stack.yaml</code>:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">flags:</span><span class="at"> </span><span class="kw">{}</span>
<span class="fu">resolver:</span><span class="at"> lts-4.0</span>
<span class="fu">packages:</span><span class="at"> </span><span class="kw">[]</span>
<span class="fu">extra-deps:</span><span class="at"> </span><span class="kw">[]</span></code></pre></div>
<p>Tell <em>Stack</em> to setup everything (download package list, install latest <em>GHC</em> release, etc.):</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">stack</span> setup</code></pre></div>
<p>Note that you can lookup the latest release of stackage at anytime on this <a href="http://www.stackage.org/lts">page</a>.</p>
<h2 id="install-zeromq-latest-version">Install ZeroMQ latest version</h2>
<p>If you try to install IHaskell directly, you’ll get an error since Ubuntu 14.04 ships with an older version of ZeroMQ. We need a more recent release. There are several ways to install it:</p>
<ol style="list-style-type: decimal">
<li>Compile it from source</li>
<li>Use Nix</li>
</ol>
<p>We’re going to compile it from source. I’ll follow the way of the official <a href="https://github.com/gibiansky/IHaskell#install-zeromq">README</a>:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co"># Compiling from source:</span>
<span class="fu">git</span> clone git@github.com:zeromq/zeromq4-x.git libzmq
<span class="bu">cd</span> libzmq
<span class="ex">./autogen.sh</span> <span class="kw">&amp;&amp;</span> <span class="ex">./configure</span> <span class="kw">&amp;&amp;</span> <span class="fu">make</span>
<span class="fu">sudo</span> make install
<span class="fu">sudo</span> ldconfig</code></pre></div>
<p>That will do the trick! If you don’t like to install packages in global scope, feel free to install it in a user folder (Add the <code>--prefix=LOCATION</code> directive to <code>./configure</code>, and change <code>LD_LIBRARY_PATH</code> and <code>PATH</code> in your shell configuration accordingly).</p>
<h2 id="install-ipython-jupyter">Install <s>IPython</s> Jupyter</h2>
<p><strong>EDIT</strong>: Following Florian’s comment, it appears that <em>IPython</em> is now officialy named <em>Jupyter</em>, so we might as well install it in our virtualenv. The only change in the instructions is to replace <code>pip install ipython</code> by <code>pip install jupyter</code> (Note that <em>IPython</em> is a dependency of <em>Jupyter</em>).</p>
<p>IHaskell requires a <s>version of <em>IPython &gt; 3.0.0 or up</em></s> recent version of <em>Jupyter</em>, so we need to install it ourselves. There are several options:</p>
<ol style="list-style-type: decimal">
<li>Use pip and install it globaly (<s><em>pip install ipython</em></s><code>pip install jupyter</code>)</li>
<li>Use pip and install it in a virtualenv (<strong>This is what we will do here</strong>)</li>
<li>Use <a href="https://nixos.org/nix/">nix</a> <em>(You’re on your own)</em></li>
<li>Use <a href="https://www.continuum.io/downloads">conda</a> (<s><em>conda update ipython</em></s><code>conda update jupyter</code>)</li>
</ol>
<p>If you’re on a fresh install: <code>sudo apt-get install python-virtualenv python-dev ncurses-base</code></p>
<p>With <code>virtualenv</code>:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">virtualenv</span> venv-ihaskell
<span class="bu">source</span> venv-ihaskell/bin/activate</code></pre></div>
<p>With <code>virtualenvwrapper</code>:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">mkvirtualenv</span> ihaskell
<span class="ex">workon</span> ihaskell</code></pre></div>
<p>Now we install <s><em>ipython</em></s> <em>Jupyter</em>:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">pip</span> install jupyter</code></pre></div>
<h2 id="install-ihaskell">Install IHaskell</h2>
<p>Nothing simpler, just use <em>Stack</em>:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">stack</span> build ihaskell</code></pre></div>
<p>You may want to install extra packages to enhance <em>IHaskell</em> capabilities. Here are the ones supported by Stackage:</p>
<ul>
<li>ihaskell-aeson</li>
<li>ihaskell-blaze</li>
<li>ihaskell-charts</li>
<li>ihaskell-diagrams</li>
<li>ihaskell-rlangqq</li>
<li>ihaskell-magic</li>
<li>ihaskell-juicypixels</li>
<li>ihaskell-hatex</li>
<li>ihaskell-basic</li>
</ul>
<p>Some others are not in the LTS snapshot of Stackage, but could be useful in the future. I don’t know about the current maturity of these packages:</p>
<ul>
<li>ihaskell-widgets (conflict with current version of singletons)</li>
<li>ihaskell-parsec (conflict with current version of aeson)</li>
<li>ihaskell-plot</li>
</ul>
<h2 id="setup-ihaskell">Setup IHaskell</h2>
<p>If everything went well, you should have <em>Jupyter</em> (latest version) and <em>ihaskell</em> installed properly. The last step is to install the <em>IHaskell Kernel</em> into <em>Jupyter</em>.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">stack</span> exec ihaskell -- install</code></pre></div>
<p>Now run the notebook server and enjoy:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">stack</span> exec jupyter -- notebook</code></pre></div>
<p>Open your browser and go to: <code>http://localhost:8000</code></p>
<h2 id="whats-next">What’s next</h2>
<p>Thanks to Stack, the install process went very smoothely (appart from some dependency we had to install ourselves). Using IPython with a Haskell Kernel I believe writing about Haskell will be a much pleasant experience since it’s really easy to export a notebook either in HTML or Markdown.</p>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
